# 6 任务模块 3: 交通系统模拟
## 6.1 动机
在该模块的第一部分中，将实现一个简单的算法问题：车辆不应在禁止超车的道路上超车。目前只能生成单独的、不连续的道路，并且车辆只能在一条道路上行驶。在最后一个任务模块中，这些将被整合为一个完整的交通网络。
为了将道路连接成一个交通网络，引入了交叉路口。车辆将开始时停放或行驶在交叉路口。当到达道路尽头时，车辆应切换到该交叉路口的另一条道路并继续行驶。为了避免在需要修改交通系统或增加更多车辆时，必须重新编译和生成整个项目，最后一步将通过描述文件中的ASCII文件生成交通网络。
在这个任务模块中将探讨以下几个方面：

- 非平凡的修改和扩展已有项目，
- 实现一个简单的算法，
- STL（映射），
- 从文件中读取数据并生成数据结构。
为了获得概览，请先通读第三个任务模块。

## 6.2 超车禁令

后续的任务可以归纳为方法编程。这意味着本章中的算法并不像之前的任务那样具体描述。

1. 创建一个名为“任务模块3”的新项目。拷贝所有源文件（仅包括 *.h 和 *.cpp 文件以及 SimuServer.jar 文件）从任务模块2到新项目，并使这些文件被新项目识别。

2. c

3. 再次测试异常类的处理方法：到达道路尽头的车辆应输出并从列表中删除。当一个停放的车辆到达起始时间时，应开始行驶（列表中的位置将发生变化），并输出它的名字、起始时间和起始点（道路）。在时间过半时，另有一辆停放的车辆应被接受加入路径。您的模拟应持续运行，直到所有车辆都开始行驶并到达路径的终点。输出应实现为能够识别出车辆在列表中的重新排序。

4. 由于在我们的交通系统中，一些不完善的道路上超车非常危险，请在 `Fahren::dStrecke()` 中实现一个超车禁令。此外，自行车也不能被超车。为了简化，可以允许并排行驶（相同位置）。超车禁令应通过一个新的布尔成员变量 `Weg::bUeberholverbot` 来控制（true = 不完善的道路，带有超车禁令）。请在 `Weg` 的构造函数中添加一个表示超车禁令的参数。如果未指定该参数，则默认认为这条道路是不完善的。另一个条件是，抛锚的汽车（即油箱空了的汽车）不应对后续车辆构成障碍。

   **提示：**除了定义道路长度外，还引入一个虚拟障碍，该障碍始终设置在当前模拟运行到的车辆位置上。后续车辆不能超过这个障碍的位置。编写一个 getter 函数来获取虚拟障碍位置，并考虑这条道路是否有超车禁令。然后在计算剩余距离时，用此函数的调用替换对道路长度的查询。
   要清楚的是，由于列表的特殊结构（见图 6.1），可以实现超车禁令。当然，也允许其他解决方案。

   ![sda](images/6.1.png)